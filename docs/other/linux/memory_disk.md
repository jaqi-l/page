
# 1.8 内存与磁盘管理
## 1.8.1 内存
`free -m`查看内存使用率,以M为单位（-g以G为单位）        
`top` 实时显示正在进行的进程，及内存占用情况        
## 1.8.2 磁盘
#### `fdisk`查看磁盘情况，对磁盘进行分区
`fdisk -l`查看全部磁盘      
`df -h`查看linux分区下的文件信息        
`du`查看文件所占磁盘大小（`ls`文件字节长度大小）        
`dd`磁盘分区        
## 1.8.3 文件系统
`ext4`：CentOS6及以前      
`xfs`：CentOS7     
`NTFS`：外置设备(需要安装NTFS软件包)       
### ext4
#### 超级块
根据全部文件生成的数据块        
#### 超级块副本
对超级快进行备份        
#### i节点
记录每一个文件的属性和权限等信息，
`ls -li`查看i节点ID     
#### 数据块
记录文件的具体数据，每4.0KB(ext4,xfs)生成块（`ls`是根据查出当前i节点下全部数据块的大小总和，不满的块也会被计算）

:::tip
`touch`创建文件，创建一个i节点和一个4.0KB(ext4,xfs)的数据块。                   
`mv`移动/改名文件，修改i节点的记录参数，如果是跨目录移动则i节点与数据块同时移动，如果跨分区移动（不是瞬间完成的）。          
`cp`复制文件，创建一个新的i节点及相应数据块。                    
`vim`编辑文件，编辑的是文件生成的缓存文件，会改变i节点，好处可以被同时打开且意外终止，不会影响源文件。           
`echo >`编辑文件，编辑的是文本本身不会改变i节点。              
`rm`删除文件，删除的是i节点与数据块的绑定关系。              
`ln`链接文件，将数据块指向某个i节点，可以多个数据块指向同一个i节点，不能跨分区。              
`ln -s`符号(软)链接文件，创建一个新的i节点指向另一个i节点，可以跨分区。不能设置单独的权限。需要使用`facl`设置权限             
:::
## 1.8.4 磁盘分区与挂载
#### `fdisk`
`fdisk`+`要分区的设备名`进入分区工具。      
`m`帮助     
`n`新建分区     
`p`查看分区     
`q`不保存退出       
`d`删除分区     
`w`保存     
#### `mkfs`格式化
#### `parted`对大于2TB的文件进行分区
#### `mount`挂载
#### 配置文件
/etc/fstab
## 1.8.5 磁盘配额
### xfx系统
1. `mkfs.xfs /dev/sdb1`
> 格式化sdb1分区        
2. `mkdir -p /mnt/disk1`
> 创建disk1分区目录     
1. `mount -o uquota,gquota /dev/sdb1 /mnt/disk1`
> 挂载sdb1分区到disk1目录       
> uquota：用户磁盘配额      
> gquota：组磁盘配额        
4. `chmod 17777 /mnt/disk1`
> 设置权限
5. `xfs_quota`+`enter键`进入xfs_quota模式
6. `xfs_quota -x -c 'report -ugibh' /mnt/disk1`
> 查看disk1磁盘配额     
> u：用户       
> g：组     
> i：节点       
> b：数据块     
> h：显示的格式     
6. `xfs_quota -x -c 'limit -u isoft=5 ihard=10 user1' /mnt/disk1`
> 配置disk1磁盘配额     
> limit：限制磁盘配额(-u：用户,-g：组)      
> soft：软限制，hard：应限制。           
> :::tip 
> 硬限制：可以在任何时候任何进程中设置  但硬限制只能由超级用户提起
> 软限制：内核实际执行的限制，任何进程都可以将软限制设置为任意小于等于对进程限制的硬限制的值。
> isoft：单次可创建的最大i节点数
> ihard：总的可创建文件i节点数
> bsoft：单次可创建的最大数据块数
> bhard：总的可创建数据块数
> :::
> user1：被操作的用户   
## 1.8.6 交换（swap）分区
### 增加交换分区(虚拟内存)
* `mkswap`      
`mkswap /dev/sdd1`将sdd1分区格式化成交换分区        
`mkswapoff /dev/sdd1`恢复sdd1分区 
* `swapon`
## 1.8.7 RAID磁盘阵列
### RAID卡
### 软件模拟RAID
mdadm：RADI软件包
## 1.8.8 逻辑卷管理
物理卷（pv）：一个物理设备即一个物理卷
逻辑卷（lv）：文件系统无法跨物理卷使用，因此在各物理卷的底层再叠加一个逻辑卷。
卷组（vg）：多个物理卷组成的组
lvm：逻辑卷管理器
### 逻辑卷的创建
1. `fdisk`添加硬盘或分区     
2. `pvcreate`+`硬盘1`+`硬盘2`:对多个硬盘同时创建物理卷       
3. `pvs`查看物理卷      
4. `vgcreate`+`卷组名`+`物理卷1`+`物理卷2`:设置卷组，一个卷不能加入两个不同的卷组     
5. `vgs`+`卷组名`查看卷组       
6. `lvcreate -l`+`空间大小`+`-n`+`逻辑卷名`+`卷组名`:创建逻辑卷
7. `lvs`查看逻辑卷
8. `mkdir /mnt/`+`目录名`:创建目录
9. `mfs.xfx /dev/`+`卷组名`+`逻辑卷名`格式化
10. `mount`挂载
### 逻辑卷的扩充
1. `vgextend` 

